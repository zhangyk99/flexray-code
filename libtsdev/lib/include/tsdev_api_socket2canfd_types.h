/**
 * Copyright (c) 2026:Shanghai TOSUN Technology Ltd.
 *
 * The software mentioned in this copyright statement includes the automatic
 * code generator function module of TSMaster software and the embedded code it
 * generates. Among them, the copyright of the automatic code generation
 * function module of TSMaster software is owned by Shanghai TOSUN Technology
 * Ltd..It is protected by the Copyright Law of the People's Republic of China,
 * the Regulations on the Protection of Computer Software, the Intellectual
 * Property Protection Law, the Patent Law of the People's Republic of China and
 * relevant international copyright treaties, laws, regulations, and other
 * intellectual property laws and treaties.
 *
 * The embedded code generated by the automatic code generation function of the
 * TSMaster is a non-commercial code whose copyright belongs to Shanghai TOSUN
 * Technology Ltd. or the original copyright owner of the embedded code, and is
 * only for personal learning and use. Shanghai TOSUN Technology Ltd. does not
 * provide any kind of warranty, whether express or implied. All risks are borne
 * by the user, and Shanghai TOSUN Technology Ltd. does not assume any joint
 * responsibility.
 *
 * The semiconductor manufacturer's LOGO and product model displayed in the
 * TSMaster are only for the convenience of user selection and useage,its
 * copyright and ownership remain with the respective copyright owners,Shanghai
 * TOSUN Technology Ltd. does not provide any guarantee and rights guarantee for
 * this, and does not assume joint and several liability for any possible
 * infringement.
 *
 * Shanghai TOSUN Technology Ltd. reserves the right to modify and upgrade the
 * software mentioned in this copyright statement without notifying users, and
 * reserves the right to modify this license agreement.
 */
#ifndef __TSDEV_API_SOCKET2CANFD_TYPES_H
#define __TSDEV_API_SOCKET2CANFD_TYPES_H
#include "tsdev_api_base_types.h"

typedef enum {
	BUFFER_CLEAR = 0,
	BUFFER_NOCLEAR = 1,
} tsdev_recvbuffer_type_t;

typedef enum {
	SOCKET_TYPE_UNUSED = 0, // Unused (ignored in total connection count)
	SOCKET_TYPE_TCP_SERVER = 1, // TCP server (no protocol restrictions, constrained as needed)
	SOCKET_TYPE_TCP_CLIENT = 2, // TCP client (adapts to "Connect" status field in protocol)
	SOCKET_TYPE_UDP = 3  // UDP mode (for connectionless transmission scenarios)
} tsdev_socket_type_t;

struct tsdev_socket_modeConf
{
	uint8_t  enabled;                       // Enable flag
	uint8_t  rev0;
	uint16_t localPort;                     // Local port (big-endian byte order)
	uint32_t targetIp;                      // Target IP address
	uint16_t targetPort;                    // Target port (big-endian byte order)    
	uint8_t  canChannel;                    // Matched CAN channel (bits indicate channel usage)
	uint8_t  canChannelNum;                 // Number of matched CAN channels
	uint8_t  canChannel_Err;                // Matched CAN channel (bits indicate usage for error frames)
	uint8_t  canChannelNum_Err;             // Number of matched CAN channels for error frames
	uint16_t rev1;
	uint32_t timeoutDisconnect;             // Connection timeout duration (in 10ms units)
	uint32_t pack_CanCnt_Time;              // Packet bundling timeout interval (ms)
	uint8_t  packetFrameCount;              // Number of frames per packet
	uint8_t  recvBufferMode;                // Receive buffer handling method
	uint8_t  mutilcastEnabled;              // Multicast enable flag
	uint8_t  rev2;
	uint32_t mutilcastIp;                   // Multicast address
};

struct tsdev_socketConf
{
	struct tsdev_socket_modeConf modeConfig; // Configuration parameters
	uint8_t       type;                      // Socket mode (unused/TCP Server/TCP Client/UDP)
	uint8_t          rev[7];
};

struct tsdev_Canfd_SocketConf_t
{
	struct tsdev_socketConf sockets[16];     // Pool of 16 socket configurations (TCP+UDP total <= 16)
	uint8_t           server_usedCount;      // Number of used server sockets
	uint8_t           client_usedCount;      // Number of used client sockets
	uint8_t           udp_usedCount;         // Number of used UDP sockets
};

#endif
